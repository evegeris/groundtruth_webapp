!function(t,n){"use strict";"function"==typeof define&&define.amd?define(["angular"],n):"object"==typeof module&&module.exports?module.exports=n(require("angular")):n(t.angular)}(this,function(t,n){"use strict";return t.module("angular-google-analytics",[]).provider("Analytics",function(){var e,i,c,r,a,o=!0,s="auto",u=!1,l=!1,f="USD",d=!1,p=!1,m=!1,g=!1,h=!1,k=!1,_=!1,y=!1,v=!1,E=!1,b=!1,w="$routeChangeSuccess",A=!1,T=!1,C="",D=!0,P=!1;this.log=[],this.offlineQueue=[],this.setAccount=function(i){return e=t.isUndefined(i)||i===!1?n:t.isArray(i)?i:t.isObject(i)?[i]:[{tracker:i,trackEvent:!0}],this},this.trackPages=function(t){return D=!!t,this},this.trackPrefix=function(t){return C=t,this},this.setDomainName=function(t){return c=t,this},this.useDisplayFeatures=function(t){return m=!!t,this},this.useAnalytics=function(t){return o=!!t,this},this.useEnhancedLinkAttribution=function(t){return _=!!t,this},this.useCrossDomainLinker=function(t){return l=!!t,this},this.setCrossLinkDomains=function(t){return i=t,this},this.setPageEvent=function(t){return w=t,this},this.setCookieConfig=function(t){return s=t,this},this.useECommerce=function(t,n){return h=!!t,k=!!n,this},this.setCurrency=function(t){return f=t,this},this.setRemoveRegExp=function(t){return t instanceof RegExp&&(a=t),this},this.setExperimentId=function(t){return r=t,this},this.ignoreFirstPageLoad=function(t){return y=!!t,this},this.trackUrlParams=function(t){return P=!!t,this},this.disableAnalytics=function(t){return g=!!t,this},this.setHybridMobileSupport=function(t){return E=!!t,this},this.startOffline=function(t){return b=!!t,b===!0&&this.delayScriptTag(!0),this},this.delayScriptTag=function(t){return p=!!t,this},this.logAllCalls=function(t){return v=!!t,this},this.enterTestMode=function(){return A=!0,this},this.enterDebugMode=function(t){return d=!0,T=!!t,this},this.$get=["$document","$location","$log","$rootScope","$window",function(x,j,L,S,I){var q=this,N=function(n,e){return t.isString(e)?e+"."+n:O("name",e)?e.name+"."+n:n},O=function(n,e){return t.isObject(e)&&t.isDefined(e[n])},$=function(t,n,e){return O(t,n)&&n[t]===e},F=function(){var t=P?j.url():j.path();return a?t.replace(a,""):t},M=function(){var n={utm_source:"campaignSource",utm_medium:"campaignMedium",utm_term:"campaignTerm",utm_content:"campaignContent",utm_campaign:"campaignName"},e={};return t.forEach(j.search(),function(i,c){var r=n[c];t.isDefined(r)&&(e[r]=i)}),e},U=function(t,n,e,i,c,r,a,o,s){var u={};return t&&(u.id=t),n&&(u.affiliation=n),e&&(u.revenue=e),i&&(u.tax=i),c&&(u.shipping=c),r&&(u.coupon=r),a&&(u.list=a),o&&(u.step=o),s&&(u.option=s),u},Q=function(t){!o&&I._gaq&&"function"==typeof t&&t()},B=function(){var t=Array.prototype.slice.call(arguments);return b===!0?void q.offlineQueue.push([B,t]):(I._gaq||(I._gaq=[]),v===!0&&q._log.apply(q,t),void I._gaq.push(t))},R=function(t){o&&I.ga&&"function"==typeof t&&t()},V=function(){var t=Array.prototype.slice.call(arguments);return b===!0?void q.offlineQueue.push([V,t]):"function"!=typeof I.ga?void q._log("warn","ga function not set on window"):(v===!0&&q._log.apply(q,t),void I.ga.apply(null,t))},X=function(t){var n=Array.prototype.slice.call(arguments,1),i=n[0],c=[];return"function"==typeof t?e.forEach(function(n){t(n)&&c.push(n)}):c=e,0===c.length?void V.apply(q,n):void c.forEach(function(t){O("select",t)&&"function"==typeof t.select&&!t.select(n)||(n[0]=N(i,t),V.apply(q,n))})};return this._log=function(){var t=Array.prototype.slice.call(arguments);if(t.length>0){if(t.length>1)switch(t[0]){case"debug":case"error":case"info":case"log":case"warn":L[t[0]](t.slice(1))}q.log.push(t)}},this._createScriptTag=function(){if(!e||e.length<1)return void q._log("warn","No account id set to create script tag");if(e.length>1&&(q._log("warn","Multiple trackers are not supported with ga.js. Using first tracker only"),e=e.slice(0,1)),u===!0)return void q._log("warn","ga.js or analytics.js script tag already created");g===!0&&(q._log("info","Analytics disabled: "+e[0].tracker),I["ga-disable-"+e[0].tracker]=!0),B("_setAccount",e[0].tracker),c&&B("_setDomainName",c),_&&B("_require","inpage_linkid","//www.google-analytics.com/plugins/ga/inpage_linkid.js"),D&&!y&&(a?B("_trackPageview",F()):B("_trackPageview"));var t,n=x[0];return t=m===!0?("https:"===n.location.protocol?"https://":"http://")+"stats.g.doubleclick.net/dc.js":("https:"===n.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js",A!==!0?!function(){var e=n.createElement("script");e.type="text/javascript",e.async=!0,e.src=t;var i=n.getElementsByTagName("script")[0];i.parentNode.insertBefore(e,i)}():q._log("inject",t),u=!0,!0},this._createAnalyticsScriptTag=function(){if(!e)return void q._log("warn","No account id set to create analytics script tag");if(u===!0)return void q._log("warn","ga.js or analytics.js script tag already created");g===!0&&e.forEach(function(t){q._log("info","Analytics disabled: "+t.tracker),I["ga-disable-"+t.tracker]=!0});var n=x[0],c=E===!0?"https:":"",a=c+"//www.google-analytics.com/"+(d?"analytics_debug.js":"analytics.js");if(A!==!0?!function(t,n,e,i,c,r,a){t.GoogleAnalyticsObject=c,t[c]=t[c]||function(){(t[c].q=t[c].q||[]).push(arguments)},t[c].l=1*new Date,r=n.createElement(e),a=n.getElementsByTagName(e)[0],r.async=1,r.src=i,a.parentNode.insertBefore(r,a)}(window,n,"script",a,"ga"):("function"!=typeof I.ga&&(I.ga=function(){}),q._log("inject",a)),T&&(I.ga_debug={trace:!0}),e.forEach(function(n){n.crossDomainLinker=O("crossDomainLinker",n)?n.crossDomainLinker:l,n.crossLinkDomains=O("crossLinkDomains",n)?n.crossLinkDomains:i,n.displayFeatures=O("displayFeatures",n)?n.displayFeatures:m,n.enhancedLinkAttribution=O("enhancedLinkAttribution",n)?n.enhancedLinkAttribution:_,n.set=O("set",n)?n.set:{},n.trackEcommerce=O("trackEcommerce",n)?n.trackEcommerce:h,n.trackEvent=!!O("trackEvent",n)&&n.trackEvent;var e={};O("fields",n)?e=n.fields:O("cookieConfig",n)?t.isString(n.cookieConfig)?e.cookieDomain=n.cookieConfig:e=n.cookieConfig:t.isString(s)?e.cookieDomain=s:s&&(e=s),n.crossDomainLinker===!0&&(e.allowLinker=!0),O("name",n)&&(e.name=n.name),n.fields=e,V("create",n.tracker,n.fields),E===!0&&V(N("set",n),"checkProtocolTask",null);for(var c in n.set)n.set.hasOwnProperty(c)&&V(N("set",n),c,n.set[c]);n.crossDomainLinker===!0&&(V(N("require",n),"linker"),t.isDefined(n.crossLinkDomains)&&V(N("linker:autoLink",n),n.crossLinkDomains)),n.displayFeatures&&V(N("require",n),"displayfeatures"),n.trackEcommerce&&(k?(V(N("require",n),"ec"),V(N("set",n),"&cu",f)):V(N("require",n),"ecommerce")),n.enhancedLinkAttribution&&V(N("require",n),"linkid"),D&&!y&&V(N("send",n),"pageview",C+F())}),r){var o=n.createElement("script"),p=n.getElementsByTagName("script")[0];o.src=c+"//www.google-analytics.com/cx/api.js?experiment="+r,p.parentNode.insertBefore(o,p)}return u=!0,!0},this._ecommerceEnabled=function(t,n){var e=h&&!k;return t===!0&&e===!1&&(h&&k?q._log("warn",n+" is not available when Enhanced Ecommerce is enabled with analytics.js"):q._log("warn","Ecommerce must be enabled to use "+n+" with analytics.js")),e},this._enhancedEcommerceEnabled=function(t,n){var e=h&&k;return t===!0&&e===!1&&q._log("warn","Enhanced Ecommerce must be enabled to use "+n+" with analytics.js"),e},this._trackPage=function(e,i,c){e=e?e:F(),i=i?i:x[0].title,Q(function(){B("_set","title",i),B("_trackPageview",C+e)}),R(function(){var r={page:C+e,title:i};t.extend(r,M()),t.isObject(c)&&t.extend(r,c),X(n,"send","pageview",r)})},this._trackEvent=function(n,e,i,c,r,a){Q(function(){B("_trackEvent",n,e,i,c,!!r)}),R(function(){var o={},s=function(t){return $("trackEvent",t,!0)};t.isDefined(r)&&(o.nonInteraction=!!r),t.isObject(a)&&t.extend(o,a),X(s,"send","event",n,e,i,c,o)})},this._addTrans=function(t,n,e,i,c,r,a,o,s){Q(function(){B("_addTrans",t,n,e,i,c,r,a,o)}),R(function(){if(q._ecommerceEnabled(!0,"addTrans")){var r=function(t){return $("trackEcommerce",t,!0)};X(r,"ecommerce:addTransaction",{id:t,affiliation:n,revenue:e,tax:i,shipping:c,currency:s||"USD"})}})},this._addItem=function(t,n,e,i,c,r){Q(function(){B("_addItem",t,n,e,i,c,r)}),R(function(){if(q._ecommerceEnabled(!0,"addItem")){var a=function(t){return $("trackEcommerce",t,!0)};X(a,"ecommerce:addItem",{id:t,name:e,sku:n,category:i,price:c,quantity:r})}})},this._trackTrans=function(){Q(function(){B("_trackTrans")}),R(function(){if(q._ecommerceEnabled(!0,"trackTrans")){var t=function(t){return $("trackEcommerce",t,!0)};X(t,"ecommerce:send")}})},this._clearTrans=function(){R(function(){if(q._ecommerceEnabled(!0,"clearTrans")){var t=function(t){return $("trackEcommerce",t,!0)};X(t,"ecommerce:clear")}})},this._addProduct=function(n,e,i,c,r,a,o,s,u,l){Q(function(){B("_addProduct",n,e,i,c,r,a,o,s,u)}),R(function(){if(q._enhancedEcommerceEnabled(!0,"addProduct")){var f=function(t){return $("trackEcommerce",t,!0)},d={id:n,name:e,category:i,brand:c,variant:r,price:a,quantity:o,coupon:s,position:u};t.isObject(l)&&t.extend(d,l),X(f,"ec:addProduct",d)}})},this._addImpression=function(t,n,e,i,c,r,a,o){Q(function(){B("_addImpression",t,n,e,i,c,r,a,o)}),R(function(){if(q._enhancedEcommerceEnabled(!0,"addImpression")){var s=function(t){return $("trackEcommerce",t,!0)};X(s,"ec:addImpression",{id:t,name:n,category:c,brand:i,variant:r,list:e,position:a,price:o})}})},this._addPromo=function(t,n,e,i){Q(function(){B("_addPromo",t,n,e,i)}),R(function(){if(q._enhancedEcommerceEnabled(!0,"addPromo")){var c=function(t){return $("trackEcommerce",t,!0)};X(c,"ec:addPromo",{id:t,name:n,creative:e,position:i})}})},this._setAction=function(t,n){Q(function(){B("_setAction",t,n)}),R(function(){if(q._enhancedEcommerceEnabled(!0,"setAction")){var e=function(t){return $("trackEcommerce",t,!0)};X(e,"ec:setAction",t,n)}})},this._trackTransaction=function(t,n,e,i,c,r,a,o,s){this._setAction("purchase",U(t,n,e,i,c,r,a,o,s))},this._trackRefund=function(t){this._setAction("refund",U(t))},this._trackCheckOut=function(t,n){this._setAction("checkout",U(null,null,null,null,null,null,null,t,n))},this._trackDetail=function(){this._setAction("detail"),this._pageView()},this._trackCart=function(t,n){["add","remove"].indexOf(t)!==-1&&(this._setAction(t,{list:n}),this._trackEvent("UX","click",t+("add"===t?" to cart":" from cart")))},this._promoClick=function(t){this._setAction("promo_click"),this._trackEvent("Internal Promotions","click",t)},this._productClick=function(t){this._setAction("click",U(null,null,null,null,null,null,t,null,null)),this._trackEvent("UX","click",t)},this._pageView=function(t){R(function(){V(N("send",t),"pageview")})},this._send=function(){var t=Array.prototype.slice.call(arguments);t.unshift("send"),R(function(){V.apply(q,t)})},this._set=function(t,n,e){R(function(){V(N("set",e),t,n)})},this._trackTimings=function(t,n,e,i){this._send("timing",t,n,e,i)},this._trackException=function(t,n){this._send("exception",{exDescription:t,exFatal:!!n})},p||(o?this._createAnalyticsScriptTag():this._createScriptTag()),D&&S.$on(w,function(){q._trackPage()}),{log:q.log,offlineQueue:q.offlineQueue,configuration:{accounts:e,universalAnalytics:o,crossDomainLinker:l,crossLinkDomains:i,currency:f,debugMode:d,delayScriptTag:p,disableAnalytics:g,displayFeatures:m,domainName:c,ecommerce:q._ecommerceEnabled(),enhancedEcommerce:q._enhancedEcommerceEnabled(),enhancedLinkAttribution:_,experimentId:r,hybridMobileSupport:E,ignoreFirstPageLoad:y,logAllCalls:v,pageEvent:w,removeRegExp:a,testMode:A,traceDebuggingMode:T,trackPrefix:C,trackRoutes:D,trackUrlParams:P},getUrl:F,setCookieConfig:q._setCookieConfig,getCookieConfig:function(){return s},createAnalyticsScriptTag:function(t){return t&&(s=t),q._createAnalyticsScriptTag()},createScriptTag:function(){return q._createScriptTag()},offline:function(t){if(t===!0&&b===!1&&(b=!0),t===!1&&b===!0)for(b=!1;q.offlineQueue.length>0;){var n=q.offlineQueue.shift();n[0].apply(q,n[1])}return b},trackPage:function(t,n,e){q._trackPage.apply(q,arguments)},trackEvent:function(t,n,e,i,c,r){q._trackEvent.apply(q,arguments)},addTrans:function(t,n,e,i,c,r,a,o,s){q._addTrans.apply(q,arguments)},addItem:function(t,n,e,i,c,r){q._addItem.apply(q,arguments)},trackTrans:function(){q._trackTrans.apply(q,arguments)},clearTrans:function(){q._clearTrans.apply(q,arguments)},addProduct:function(t,n,e,i,c,r,a,o,s,u){q._addProduct.apply(q,arguments)},addPromo:function(t,n,e,i){q._addPromo.apply(q,arguments)},addImpression:function(t,n,e,i,c,r,a,o){q._addImpression.apply(q,arguments)},productClick:function(t){q._productClick.apply(q,arguments)},promoClick:function(t){q._promoClick.apply(q,arguments)},trackDetail:function(){q._trackDetail.apply(q,arguments)},trackCart:function(t,n){q._trackCart.apply(q,arguments)},trackCheckout:function(t,n){q._trackCheckOut.apply(q,arguments)},trackTimings:function(t,n,e,i){q._trackTimings.apply(q,arguments)},trackTransaction:function(t,n,e,i,c,r,a,o,s){q._trackTransaction.apply(q,arguments)},trackException:function(t,n){q._trackException.apply(q,arguments)},setAction:function(t,n){q._setAction.apply(q,arguments)},pageView:function(){q._pageView.apply(q,arguments)},send:function(t){q._send.apply(q,arguments)},set:function(t,n,e){q._set.apply(q,arguments)}}}]}).directive("gaTrackEvent",["Analytics","$parse",function(t,n){return{restrict:"A",link:function(e,i,c){var r=n(c.gaTrackEvent);i.bind("click",function(){c.gaTrackEventIf&&!e.$eval(c.gaTrackEventIf)||r.length>1&&t.trackEvent.apply(t,r(e))})}}}]),t.module("angular-google-analytics")});